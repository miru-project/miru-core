syntax = "proto3";

package miru;

option go_package = "github.com/miru-project/miru-core/proto";

message ExtensionMeta {
  string name = 1;
  string version = 2;
  string author = 3;
  string license = 4;
  string lang = 5;
  string icon = 6;
  string package = 7;
  string webSite = 8;
  string description = 9;
  repeated string tags = 10;
  string api = 11;
  string error = 12;
  string type = 13;
}

message DownloadProgress {
  int32 progress = 1;
  repeated string names = 2;
  int32 total = 3;
  string status = 4;
  string media_type = 5;
  string current_downloading = 6;
  int32 task_id = 7;
  string title = 8;
  string package = 9;
  string key = 10;
}

message TorrentStats {
  int64 total_down = 1;
  int64 total_up = 2;
}

message ExtensionListItem {
  string title = 1;
  string url = 2;
  string cover = 3;
  string update = 4;
}

message AvailableHlsVariant {
  string resolution = 1;
  string url = 2;
  string codec = 3;
}

// DB - Detail
message Detail {
  int32 id = 1;
  optional string title = 2;
  optional string cover = 3;
  optional string desc = 4;
  string detail_url = 5; // The key used in extension
  string package = 6;
  repeated string downloaded = 7;
  // JSON encoded strings for complex types to mirror frontend ExtensionDetail
  optional string episodes = 8;
  optional string headers = 9;
}

// DB - Favorite
message Favorite {
  int32 id = 1;
  string package = 2;
  string url = 3;
  string type = 4;
  string title = 5;
  string cover = 6;
  string date = 7; // ISO8601
}

message FavoriteGroup {
  int32 id = 1;
  string name = 2;
  string date = 3; // ISO8601
  repeated Favorite favorites = 4;
}

// History
message History {
  int32 id = 1;
  string package = 2;
  string url = 3;
  string cover = 4;
  string type = 5;
  int32 episode_group_id = 6;
  int32 episode_id = 7;
  string title = 8;
  string episode_title = 9;
  int32 progress = 10;
  int32 total_progress = 11;
  string date = 12; // ISO8601
  string detail_url = 13;
}

// Download
message Download {
  int32 id = 1;
  repeated string url = 2;
  map<string, string> headers = 3;
  string package = 4;
  repeated int32 progress = 5;
  string key = 6;
  string title = 7;
  string media_type = 8;
  string status = 9;
  string save_path = 10;
  string date = 11;
  string download_url = 12;
  string detail_url = 13;
}

// Torrent
message TorrentResult {
  string info_hash = 1;
  string name = 2;
  repeated string files = 3;
}
